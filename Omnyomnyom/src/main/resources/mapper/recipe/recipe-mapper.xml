<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="recipe">
	<select id="ingredientAjax" resultType="ingredient">
		select *
		from TB_Ingredient
		where ingredient_name like '%'||#{ingr}||'%'
	</select>
	<insert id="recipeUpload" parameterType="recipe">
		insert into 
			TB_recipe
		values(
			seq_recipe.nextval,
			#{recipeName},
			#{recipeId},
			#{timeline},
			#{menuName},
			#{chefNick},
			#{chefId},
			#{cookingTime},
			#{category},
			#{recipeContent},
			default,
			default
		)
		<selectKey keyProperty="recipeNo" resultType="_int" order="AFTER">
			select seq_recipe.currval from dual
		</selectKey>
	</insert>
	<insert id="recipeIngrUpload" parameterType="recipeIngredient">
		insert into
			tb_rec_Ingredients
		values(
			#{recipeNo},
			<choose>
				<when test="ingredientNo!=0">
					#{ingredientNo},
				</when>
				<when test="ingredientNo==0">
					null,
				</when>
			</choose>
			#{minWeight},
			#{ingredientName}
		)
	</insert>
</mapper>